% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Griffiths.R
\name{Griffiths}
\alias{Griffiths}
\title{Griffiths' Age-Structured FOI Model with Maternal Antibody Cutoff Ï„}
\usage{
Griffiths(t, y, n, tau)
}
\arguments{
\item{t}{A numeric vector of exact ages, or a matrix with two columns giving the lower and upper bounds of age intervals.}

\item{y}{A numeric vector of seropositive counts for each age group or interval.}

\item{n}{A numeric vector of total sample sizes for each age group or interval.}

\item{tau}{The age (in the same units as \code{t}) after which maternal antibodies wane and individuals become susceptible to infection.}
}
\value{
A list with:
\describe{
\item{par}{Maximum likelihood estimates for \code{gamma0} and \code{gamma1}.}
\item{CIs}{Bootstrap-based 95\% confidence intervals for \code{gamma0} and \code{gamma1}.}
\item{boot_params}{Bootstrap samples for \code{gamma0} and \code{gamma1}.}
}
}
\description{
Fits a catalytic model in which the force of infection (FOI) becomes active only after a cutoff age \eqn{\tau}, representing
the age beyond which maternal antibodies are no longer protective. The FOI increases linearly with age after this cutoff.
}
\details{
The FOI is defined as: \eqn{\lambda(t) = \gamma_0(t + \gamma_1)\mathbf{1}\{t > \tau\}}.
The cumulative probability of seroconversion is then:
\deqn{\pi(t) = 1 - \exp\left(-\int_0^t \lambda(w) dw\right)}

For exact ages, the model directly evaluates \eqn{\pi(t)}. For age intervals \link{a, b}, the model integrates \eqn{\pi(t)} over the interval
and returns the average value.

This model is suitable when infection dynamics are known to be negligible during early life due to maternal immunity,
and begin increasing with age thereafter.
}
\examples{
# Example using exact ages
set.seed(123)
t_exact <- 1:10
y <- c(0, 0, 1, 2, 3, 4, 5, 6, 7, 8)
n <- rep(10, length(t_exact))
tau <- 2
result1 <- Griffiths(t_exact, y, n, tau)
result1$par

# Example using age intervals
t_intervals <- matrix(c(0,1, 1,2, 2,3, 3,4, 4,5), ncol = 2, byrow = TRUE)
y_int <- c(0, 0, 1, 2, 3)
n_int <- rep(10, 5)
tau <- 1
result2 <- Griffiths(t_intervals, y_int, n_int, tau)
result2$CIs

}
