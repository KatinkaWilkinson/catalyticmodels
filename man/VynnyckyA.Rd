% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/VynnyckyA.R
\name{VynnyckyA}
\alias{VynnyckyA}
\title{Vynnycky Catalytic Model A (Piecewise FOI with Assay Sensitivity)}
\usage{
VynnyckyA(t, y, n)
}
\arguments{
\item{t}{A numeric vector of exact ages, or a matrix with two columns giving the lower and upper bounds of age intervals.}

\item{y}{A numeric vector of seropositive counts for each age group or interval.}

\item{n}{A numeric vector of total sample sizes for each age group or interval.}
}
\value{
A list with:
\describe{
\item{par}{Maximum likelihood estimates for \code{rho}, \code{foi_y} (youth FOI), and \code{foi_o} (older FOI).}
\item{CIs}{Bootstrap-based 95\% confidence intervals for each parameter.}
\item{boot_params}{Bootstrap samples for \code{rho}, \code{foi_y}, and \code{foi_o}.}
}
}
\description{
Implements a catalytic model with piecewise constant force of infection (FOI) and a scaling factor \eqn{\rho}
that accounts for imperfect assay sensitivity or partial immunity. This model captures two distinct transmission phases:
}
\details{
\deqn{
\pi(t) =
\begin{cases}
  \rho \left(1 - \exp(-\lambda_y (t - 0.5))\right), & \text{for } t < 13 \\
  \rho \left(1 - \exp(-\lambda_y \cdot 12.5 - \lambda_o (t - 13))\right), & \text{for } t \ge 13
\end{cases}
}

For age intervals \eqn{[a, b]}, the model computes the average seroprevalence by numerically integrating \eqn{\pi(t)} across the interval.

This model is especially useful in seroepidemiological studies where transmission intensity differs by age,
and not all infections lead to seroconversion (or detection), which is captured by the \code{rho} parameter.
}
\examples{
# Example with exact ages
t <- 1:20
y <- round(10 * (1 - exp(-0.3 * pmin(t - 0.5, 12.5) - 0.2 * pmax(0, t - 13))))
n <- rep(10, length(t))
result <- VynnyckyA(t, y, n)
result$par

# Example with age intervals
age_intervals <- matrix(c(0,2, 2,5, 5,10, 10,15, 15,20), ncol=2, byrow=TRUE)
y <- c(1, 3, 6, 8, 9)
n <- rep(10, 5)
result <- VynnyckyA(age_intervals, y, n)
result$CIs

}
