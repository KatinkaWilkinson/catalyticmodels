% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/NonparametricKeidings.R
\name{NonparametricKeidings}
\alias{NonparametricKeidings}
\title{Nonparametric FOI Estimation using Isotonic Regression (Keiding's Method)}
\usage{
NonparametricKeidings(t, y, n)
}
\arguments{
\item{t}{A numeric vector of exact ages or midpoint values (assumed to be ordered or will be sorted internally).}

\item{y}{A numeric vector of seropositive counts at each age.}

\item{n}{A numeric vector of total sample sizes at each age.}
}
\value{
A list with:
\describe{
\item{\code{t}}{The age vector corresponding to each FOI estimate (excluding the first point due to differencing).}
\item{\code{foi}}{The pointwise maximum likelihood estimates of the force of infection.}
\item{\code{foi_CI}}{Bootstrap-based 95\% confidence intervals for FOI estimates.}
}
}
\description{
Estimates the force of infection (FOI) nonparametrically using isotonic regression (via the Pool-Adjacent Violators Algorithm),
assuming that seroprevalence increases monotonically with age. The FOI is obtained as the derivative of seroprevalence
with respect to age, scaled by the susceptible fraction.
}
\details{
This method estimates cumulative seroprevalence \eqn{\pi(t)} using isotonic regression, ensuring a non-decreasing relationship with age.
The FOI is computed as:
\deqn{
\lambda(t) = \frac{d\pi(t)/dt}{1 - \pi(t)}
}
Bootstrap resampling is used to estimate uncertainty.
}
