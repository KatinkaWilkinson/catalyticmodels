% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/NonparametricSplines.R
\name{NonparametricSplines}
\alias{NonparametricSplines}
\title{Nonparametric Estimation of Force of Infection via Splines}
\usage{
NonparametricSplines(t, y, n)
}
\arguments{
\item{t}{A numeric vector of exact ages.}

\item{y}{A numeric vector of seropositive counts at each age.}

\item{n}{A numeric vector of total sample sizes at each age.}
}
\value{
A list with:
\describe{
\item{\code{t}}{Vector of age points (excluding last grid point).}
\item{\code{foi}}{Estimated force of infection at each age.}
\item{\code{foi_CI}}{Matrix with 95\% bootstrap confidence intervals (rows = lower and upper bounds).}
}
}
\description{
Estimates the force of infection (FOI) as a function of age using a smoothed spline fit
to the observed seroprevalence. This approach assumes exact ages and does not yet account
for age intervals or grouped data.
}
\details{
The force of infection is estimated as:
\deqn{
\text{FOI}(t) = \frac{d\pi(t)/dt}{1 - \pi(t)}
}
where \eqn{\pi(t)} is the estimated seroprevalence at age \eqn{t}.

The function fits a smoothed spline to \eqn{y/n} and uses numerical differentiation to approximate
the derivative of seroprevalence. This is then used to estimate the force of infection.

Note: This version assumes input ages represent point values. To extend this to age intervals,
one could integrate the spline over each interval or use midpoints as proxies.
}
