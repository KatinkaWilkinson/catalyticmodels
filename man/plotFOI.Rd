% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Plot.R
\name{plotFOI}
\alias{plotFOI}
\title{Plot Force of Infection (FOI) curves from fitted catalytic models}
\usage{
plotFOI(
  cat_models,
  from,
  to,
  confint = FALSE,
  true_foi = NA,
  line_colors = NULL,
  xmin = 0,
  ymin = 0,
  xmax = NA,
  ymax = NA,
  true_fill = "grey80"
)
}
\arguments{
\item{cat_models}{A single fitted catalytic model object or a named list of such
objects. Each model is expected to provide:
\itemize{
\item \code{foi_t}: function mapping ages and parameters to FOI, e.g. \code{function(t, par) \{...\}}.
\item \code{params_MLE}: named numeric vector (or list) of MLE parameters.
\item \code{bootparams}: (required if \code{confint = TRUE} and non-spline) a matrix of
bootstrap parameter draws, one row per bootstrap.
\item \code{spline_pi_t}: (spline models only) a \code{smooth.spline} fit used by \code{foi_t}.
\item \code{boot_spline_pi_t}: (optional, spline CIs) list of \code{smooth.spline} fits,
one per bootstrap. If absent, ribbons are omitted for spline models even when \code{confint = TRUE}.
}
If \code{cat_models} is unnamed, legend labels are auto-generated as
\code{"Model 1"}, \code{"Model 2"}, etc.}

\item{from, to}{Numeric scalars. Age range to evaluate and plot (inclusive).}

\item{confint}{Logical. If \code{TRUE}, draws 95\\% ribbons from bootstrap
percentiles. For non-spline models, FOI is recomputed for each age grid point
using rows of \code{bootparams}. For spline models, ribbons are shown only when
\code{boot_spline_pi_t} is supplied.}

\item{true_foi}{Optional. A list or data frame with components
\code{t} (a two-column matrix of age intervals [a, b]) and
\code{foi} (numeric of the same length) to draw semi-transparent rectangles
indicating a known/true FOI per interval.}

\item{line_colors}{Optional. Either (i) a named character vector of colors where
names match \code{names(cat_models)}, or (ii) an unnamed vector recycled across
models. If omitted, a colorblind-friendly HCL palette (when available) is used.}

\item{xmin, ymin, xmax, ymax}{Numeric limits passed to \code{coord_cartesian()}.
Use \code{NA} for any bound you want ggplot2 to choose from the data.}

\item{true_fill}{Fill color for the \code{true_foi} rectangles (default \code{"grey80"}).}
}
\value{
A \code{ggplot} object showing FOI curves (and ribbons/rectangles if requested).
}
\description{
Produces a line plot of estimated force of infection (FOI) over age for one
or more fitted catalytic models, with optional bootstrap confidence ribbons
and optional bars for a known/true FOI by age interval.
}
\details{
\itemize{
\item FOI is evaluated on an internal grid of 100 ages from \code{from} to \code{to}.
\item Ribbons use the 2.5\\% and 97.5\\% quantiles at each grid point.
\item For spline models, FOI is computed via \code{foi_t(t, spline_pi_t)}.
\item For non-spline models, FOI is computed via \code{foi_t(t, params_MLE)}.
}
}
\examples{
\dontrun{
# Age-intervals and midpoints
t <- matrix(
  c(
    0, 1,
    1, 5,
    5, 10,
    10, 15,
    15, 20,
    20, 30,
    30, 40,
    40, 50,
    50, 60
  ),
  ncol = 2, byrow = TRUE
)
t_mid <- rowMeans(t)

# Observed positives and totals
y <- c(28, 224, 577, 712, 740, 808, 848, 873, 894)
n <- rep(1000, length(y))

# True FOI by interval (rounded)
true_foi <- round(c(
  0.02958701, 0.06343983, 0.18413499, 0.08801705, 0.04843492,
  0.03307834, 0.04797940, 0.03155037, 0.01551178
), 4)

# Fit Farringtons FOI on exact-age midpoints
Farrington_exactt <- FoiFromCatalyticModel(
  t = t_mid,
  y = y,
  n = n,
  catalytic_model_type = "SimpleCatalytic",
  foi_functional_form = "Farringtons",
  lower = c(0, 0, 0),
  boot_num = 100
)

# Plot FOI with bootstrap ribbons and true interval FOI as rectangles
plotFOI(
  list(Farrington_exactt = Farrington_exactt),
  from = 0, to = 60, confint=TRUE,
  true_foi = list(foi = true_foi, t = t)
)
}

}
\seealso{
\code{\link{FoiFromCatalyticModel}}
}
