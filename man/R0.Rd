% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/R0.R
\name{R0}
\alias{R0}
\title{Estimate R0 from a fitted catalytic model by age-bin averaging}
\usage{
R0(cat_model, age_bins, pop_per_bin)
}
\arguments{
\item{cat_model}{A fitted catalytic model object from your workflow. For
spline models it must provide at least:
\code{$spline_pi_t} (a \code{smooth.spline} for \(\pi(t)\)),
\code{$t} (observation times; vector or two-column matrix of lower/upper
bounds), \code{$n} (trial sizes), and \code{$boot_y} (bootstrap counts laid
out row-wise for refitting). For closed-form models it must provide:
\code{$group_pi} (function \code{group_pi(a,b,par)} returning mean
seroprevalence in \(\link{a,b}\)), \code{$params_MLE} (named numeric),
and \code{$bootparams} (matrix of bootstrap parameter draws; one set per row).}

\item{age_bins}{Numeric matrix with two columns \code{[lower, upper]} giving
the age-bin edges (same units as the model’s \code{t}). One row per age bin.}

\item{pop_per_bin}{Numeric vector of population counts per age bin. Length
must equal \code{nrow(age_bins)}. Values are internally normalised to
fractions \eqn{f_a}.}
}
\value{
A list with:
\describe{
\item{\code{R0}}{Point estimate of \(R_0\).}
\item{\code{R0_CI}}{A length-2 named numeric vector with the 2.5\% and 97.5\%
bootstrap quantiles.}
}
}
\description{
Computes a crude basic reproduction number \eqn{R_0} from a fitted catalytic
model by averaging the model-predicted seroprevalence within user-defined
age bins and combining these with population weights. The estimator used is
\deqn{R_0 = 1 / \{ 1 - \sum_a f_a \, \bar{\pi}(a) \},}
where \eqn{f_a} is the fraction of the population in age bin \eqn{a}, and
\eqn{\bar{\pi}(a)} is the mean predicted seroprevalence in that bin.
}
\details{
The function supports two classes of fitted objects:
\itemize{
\item \strong{Spline models}: identified by \code{cat_model$spline_pi_t}.
Mean seroprevalence per bin is computed by numerical integration of
the spline prediction. Bootstrap uncertainty is propagated by refitting
a spline to each bootstrap sample in \code{cat_model$boot_y} and repeating
the bin means and \(R_0\) calculation.
\item \strong{Closed-form models}: identified by the presence of
\code{cat_model$group_pi}, \code{cat_model$params_MLE}, and
\code{cat_model$bootparams}. Mean seroprevalence per bin is obtained via
\code{group_pi(lower, upper, par)}, then \(R_0\) is computed for the MLE
and for each bootstrap parameter set.
}

\itemize{
\item For spline models, bin means \(\bar{\pi}(a)\) are computed as
\(\frac{1}{u-l}\int_l^u \hat{\pi}(t)\,dt\) using \code{stats::integrate} on
the spline’s \code{predict()}ed values. For each bootstrap \code{y} the code
refits a \code{smooth.spline} to either the midpoints (interval data) or
the raw times \code{t} (point data).
\item For closed-form models, \code{group_pi()} is used per bin and the
result is clipped to \code{[0,1]} for numerical safety.
\item The \(R_0\) identity assumes endemic equilibrium and life-long immunity;
interpret with care when these assumptions do not hold.
}
}
\section{Requirements and assumptions}{

\itemize{
\item \code{age_bins} has two columns \code{[lower, upper]} with
\code{lower < upper} for all rows.
\item \code{pop_per_bin} is non-negative with at least one positive entry.
\item For spline models, \code{spline_pi_t} is a \code{smooth.spline} whose
\code{predict()} returns a list with element \code{$y} on numeric input.
}
}

\examples{
\dontrun{
# Define bins and population
age_bins <- matrix(c(0,5, 5,10, 10,15, 15,20), ncol = 2, byrow = TRUE)
pop      <- c(1200, 1300, 1100, 1000)

# Closed-form example
R0(cm_parametric, age_bins, pop)

# Spline example
R0(cm_spline, age_bins, pop)
}

}
\seealso{
\code{\link[stats]{integrate}}, \code{\link[stats]{smooth.spline}},
\code{\link[stats]{predict}}, \code{\link[stats]{quantile}}
}
